# Module_27_7

# (Modified  Module_25_7_Chat_plus_DB_with_LogFile)

Программа представляет собой ***доработанный чат***, в котором организовано ***хранение данных чата в базе данных***, а также организовано ***логгирование***.

В данной программе также доработан файл CMakeLists.

Перед началом работы программу необходимо собрать. Для этого необходимо зайти в папку build, вызвать терминал и ввести команду "cmake ..", после чего выполнятся прописанные в файле CMakeLists инструкции и программа соберётся в этой папке. Далее, используя скрипт из папки SQL, создаём базу данных с двумя таблицами. Теперь с программой можно работать полнофункционально!

Информационные записи о работе пронраммы сохраняются в файл "***chat.log***".

Перед закрытием прораммы по моей логике реализовано ***построчное считывание файла логов*** с выводом содержимого в консоль. Но, по сути, считывание и вывод в консоль могут вызываться не только в конце программы. И это будет работать корректно благодаря тому, что ***запись и чтение реализованы потокобезопасно***.

База данных состоит из двух таблиц (**users** - таблица с данными о пользователях, и **messages** - таблица сообщений).

Таблица **users** состоит из диух полей - **login** (логин пользователя) и **password** (пароль в зашифрованном виде (SHA)).

Таблица **messages** состоит из трёх полей - от кого (**login_from**), кому (**login_to**) и непосредственно текст сообщения (**message**).

Для корректной работы программы необходимо запустить сервер MySQL от имени администратора (например, через командную строку командой "mysql -u root -p"). На сервере развернуть базу данных с двумя необходимыми таблицами. Для этого (как один из возможных вариантов, предлагаю через программу MySQL Workbench запустить скрипт, содержащийся в папке SQL данного реппозитория. Первая строка там закомментирована, её можно раскомментировать при необходимости удаления существующей базы данных).

В данной программе для работы с паролями в явном и зашифрованном виде использована функция strtoul(), которая конвертирует строку в число в формате unsigned long.

В дальнейшем для более привычного восприятия информации при выводе в консоль логов предполагается осуществить отображение времени записи лога в файл в привычном виде (год-месяц-число часы-минуты-секунды).